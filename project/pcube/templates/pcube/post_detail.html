{% extends 'pcube/base.html' %} {% load static %} {% block headers %}
<link rel="stylesheet" type="text/css" href="{% static 'pcube/postdetails.css' %}"> {% endblock headers %} {% block content %}
<div class="container">
    <div class="owner_info">
        <div class="small-profile">
            <div class="profile-img">
                <img src="{{object.owner.profile.image.url}}" alt="">
            </div>
            <div class="profile-text">
                <a href="{% url 'user-posts' object.owner.username %}">
                    <h2>{{object.owner.profile.fullname}}</h2>
                </a>
                <h5>{{ object.owner.email }}</h5>
            </div>
        </div>
        {% if request.user == object.owner %}
            <div class="buyers-list">
                <table>
                    <th colspan = "4" style="border-radius: 30px 30px 0 0;border-bottom:5px solid #aaa;">Buyers</th>
                    <tr>
                        <th>username</th>
                        <th>price</th>
                        <th></th>
                        <th></th>
                    </tr>
                    {% for buyer in buyers %}
                    <tr>
                        <td>{{buyer.user_id.username}}</td>
                        <td>&#8377; {{buyer.price}}</td>
                        <td> <span class="sell">sell</span></td>
                        <td> <span class="del">del</span></td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        {% endif %}
    </div>
    <div class="post_info">
        <h6>{{ object.date_posted|date:"F d, Y"}}</h6>
        <div class="disc">
            <div class="disc1">
                <div class="title">
                    <h1>{{ object.title }}</h1>
                    <h5>{{ object.brand }}</h5>
                </div>
                <div class="prices">
                    <h3>New Price: <span> &#8377;{{ object.newprice }}</span></h3>
                    <h4>Old Price: <span class="old"> &#8377;{{ object.oldprice }}</span>
                    </h4>
                </div>
                <span>discription:</span>
                <p>{{ object.discription }}</p>
            </div>
            <div class="disc2">
                <img src="{{ object.image.url }}" alt="object.image.url">
                <br>
                <div class="add">
                    <p>{{ object.address }}</p>
                    <p>{{ object.state }}</p>
                    <p>{{ object.city }}</p>
                </div>
            </div>
        </div>

        <div class="sure" id="sure">
            {% if request.user == object.owner %}
            <h3>Are you sure? You wan't to Delete it.</h3>
            <form method="POST" action="{% url 'post-detail' object.id%}" class="buttons">

                {% csrf_token %}
                <input class="btn" onclick="cncl()" type="button" value="Cancel">
                <input type="submit" value="Yes">
            </form>
            {% else %}
            <h3>How much are you ready to pay for this product?</h3>
            <form method="POST" action="{% url 'post-buy' %}" class="buttons">
                {% csrf_token %}
                <input class="btn" onclick="cncl()" type="button" value="Cancel">
                <input class="btn" type="number" name="price" id="price" min="{{ object.newprice }}" required>
                
                <button class="btn dn" type="submit" name="post_id" value="{{ object.id }}">Done</button>
            </form>
            {% endif %}
        </div>

        <hr>
        <div class="buttons">
            {% if request.user == object.owner %}
                <a class="btn" href="{% url 'post-update' object.id %}">Update</a>
                <input class="btn dgr" onclick="del()" type="button" value="Delete"> 
                <button class="btn lk">{{total_likes}} Like{{total_likes|pluralize}}</button>
            {% else %} 
                {% if is_requested %}
                    <form method="POST" action="{% url 'post-buy' %}" class="buttons">
                    {% csrf_token %}
                        <button class="btn" type="submit" name="post_id" value="{{object.id}}">Cancel Request</button>
                    </form>
                {% else %}
                    <input class="btn" onclick="del()" type="button" value="Request"> 
                {% endif %}
                <form action="{% url 'post-like' %}" method="POST">
                    {% csrf_token %} {% if is_liked %}
                    <button id="like" class="btn ulk" type="submit" name="post_id" value="{{ object.id }}"><i class="fa fa-heart" style="font-size:25px;"></i></button> {% else %}
                    <button id="like" class="btn lk" type="submit" name="post_id" value="{{ object.id }}"><i class="fa fa-heart-o" style="font-size:25px;"></i></button> {% endif %}
                </form>
            {% endif %}
        </div>
    </div>
</div>
<script src="{% static 'pcube/postdetails.js' %}"></script>
{% if request.user == object.owner %}
   <style>
        .post_info {
        width: 50%;
    }
    .owner_info{
        width: 50%;
    }
    .disc2 img{
        max-height: 400px;
        max-width: 300px;
        z-index: -10;
    }
    .small-profile {
        postition:relative;
        left: 25%;
    }
   </style>
{%endif%}
{% endblock content %}